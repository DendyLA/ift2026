{% extends "core/base.html" %}
{% load static i18n %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/swiper-bundle.min.css' %}" />
<link rel="stylesheet" href="{% static 'core/css/index.css' %}">
<link rel="stylesheet" href="{% static 'core/css/partners.css' %}">
{% endblock extra_css %}

{% block meta_description %}
	{% trans "IFT2026 — Investment to the Future of Turkmenistan. International investment forum uniting investors, business and government." %} 
{% endblock %}

{% block meta_keywords %}
 	{% trans "investment forum, Turkmenistan investment, IFT2026, business forum, economy" %} 
{% endblock %}

{% block og_title %}
	{% trans "IFT2026 — Investment Forum" %} 
{% endblock %}

{% block og_description %}
{% endblock %}


{% block content %}
<section class="intro">
	<video class="intro__video" autoplay muted loop playsinline >
    <source src="{{ intro.video.url }}" type="video/mp4">
</video>

	<div class="container">
		<h1 class="intro__title">{% trans "IFT2026 Investment in the future of Turkmenistan" %} </h1>
		<p class="intro__subtitle">{% trans "Join discussions, share ideas, and connect with delegates from around the world." %} </p>
		<div class="intro__buttons">
			<a href="" class="intro__button button">{% trans "Official support" %}</a>
			<a href="" class="intro__button button">{% trans "Agenda" %} </a>
			<a href="#partners" class="intro__button button">{% trans "Partners" %} </a>
		</div>
	</div>
</section>

<section class="about">
	<div class="container">
		<div class="about__wrapper">
			<div class="about__img"><img src="{{ about.image.url }}" alt="ift 2026"></div>
			<div class="about__content">
				<h3 class="about__title title">{{ about.title }}</h3>
				<div class="about__descr">{{ about.description|safe }}</div>
				<a href="{% url "about:about" %}" class="button about__btn">{% trans "Details" %} </a>
			</div>
			<div class="about__tabs">
				{% for tab in tabs %}
				<div class="about__tab">
					<img src="{{ tab.img_optimized.url }}" alt="Tab Image">
				</div>
				{% endfor %}
			</div>
		</div>
	</div>
</section>


<section class="news">
	<div class="container">
		<div class="news__top">
			<div class="news__title title">{% trans "Latest News" %}</div>
			<div class="news__btn">
				<a href="{% url "news:news" %}" class="button">{% trans "More News & Insights" %}</a>
			</div>
			
		</div>
		
		<div class="news__wrapper">
			<div class="news__left">
				{% if latest_news %}
					{% for news in latest_news %}
						<div class="news__item">
							<a href="{% url 'news:detail' slug=news.slug %}" class="news__img">
								<img 
									src="{% if news.image %}{{ news.image_preview.url }}{% else %}{% static 'img/noPhoto.jpg' %}{% endif %}" 
									alt="{{ news.title }}" 
									loading="lazy">
							</a>
							<div class="news__name">
								<div class="news__date">{{ news.date }}</div>
								<a href="{% url 'news:detail' slug=news.slug %}">{{ news.title }}</a>
							</div>
							{% comment %} <div class="news__descr">
								{{ news.content|truncatewords:30|safe }}
							</div> {% endcomment %}
						</div>
					{% endfor %}
				{% else %}
					<p>{% trans "No news available at the moment." %}</p>
				{% endif %}
			</div>
			<div class="news__right">
				{% if more_news %}
					{% with news=more_news.0 %}
						<div class="news__img">
							<a href="{% url 'news:detail' slug=news.slug %}">
								<img 
									src="{% if news.image %}{{ news.image_preview.url }}{% else %}{% static 'img/noPhoto.jpg' %}{% endif %}" 
									alt="{{ news.title }}" 
									loading="lazy">
							</a>
						</div>
						<div class="news__name">
							<div class="news__date">{{ news.date|date:"d.m.Y" }}</div>
							<a href="{% url 'news:detail' slug=news.slug %}">{{ news.title }}</a>
						</div>
					{% endwith %}
				{% else %}
					<p>{% trans "No news available." %}</p>
				{% endif %}
			</div>

			
		</div>
	</div>
</section>

<section class="partners" id="partners">
	<div class="container">
		<div class="partners__wrapper">
			{% comment %} <h4 class="title partners__title">{% trans "Partners" %} </h4> {% endcomment %}
			<div class="partners__top">
				<ul class="partners__menu">
					{% for type in partnership_types %}
						<li class="partners__item {% if forloop.first %}active{% endif %}" 
							data-type="{{ type.id }}">
							<span>{{ type.name }}</span>
						</li>
					{% endfor %}
				</ul>
			</div>

			<div class="partners__bottom swiper">
				<div class="partners__list swiper-wrapper">
					{% for partner in partnership_types.0.partners.all %}
						<a class="partners__list-item swiper-slide" href="{{ partner.link }}" target="_blank">
							
							<img 
								src="{{ partner.logo.url }}" 
								alt="{{ partner.name }}" 
								class="partners__img
									{% if partner.level %}
										partners__img--{{ partner.level.name|lower }}
									{% endif %}"
							>

							<div class="partners__name">{{ partner.name }}</div>

						</a>
					{% endfor %}
				</div>

				<div class="swiper-button-prev"></div>
				<div class="swiper-button-next"></div>
			</div>

		</div>
	</div>
</section>


{% comment %} <section class="speakers">
	<div class="container">
		<div class="speakers__wrapper">
			<div class="speakers__item">
				<div class="speakers__img"><img src="" alt=""></div>
				<div class="speakers__name"></div>
				<div class="speakers__position"></div>
			</div>
		</div>
	</div>
</section> {% endcomment %}


{% if user.is_authenticated %}
<div id="profile-popup" class="popup-overlay">
	<div class="popup-content">
		<button id="close-popup" class="popup-close">&times;</button>
		<h2>Заполните профиль</h2>
		<p>Чтобы учавствовать в форуме, пожалуйста, заполните информацию о себе.</p>
		<a href="{% url 'accounts:profile' %}" class="button">Перейти к профилю</a>
	</div>
</div>
{% endif %}



{% endblock content %}

{% block extra_js %}
<script src="{% static 'js/swiper-bundle.min.js' %}"></script>
<script src="{% static 'core/js/popup.js' %}"></script>
<script src="{% static 'core/js/index.js' %}"></script>




<script>
document.addEventListener('DOMContentLoaded', function () {

    const menuItems = document.querySelectorAll('.partners__item');
    const sliderEl = document.querySelector('.partners__bottom'); // ❗ КОНТЕЙНЕР
    const wrapperEl = sliderEl.querySelector('.partners__list');

    const allPartners = [
        {% for type in partnership_types %}
        {
            typeId: {{ type.id }},
            partners: [
                {% for partner in type.partners.all %}
                {
                    name: "{{ partner.name|escapejs }}",
                    logo: "{{ partner.logo.url|default:'' }}"
                },
                {% endfor %}
            ]
        },
        {% endfor %}
    ];

    // === ИНИЦИАЛИЗАЦИЯ SWIPER ===
    const swiper = new Swiper(sliderEl, {
        slidesPerView: 5,
        spaceBetween: 20,

        navigation: {
            nextEl: '.swiper-button-next',
            prevEl: '.swiper-button-prev',
        },

        breakpoints: {
            1200: { slidesPerView: 5 },
            992:  { slidesPerView: 4 },
            768:  { slidesPerView: 3 },
            480:  { slidesPerView: 2 },
			320: { slidesPerView: 1 },
        },

        watchOverflow: true,
        observer: true,
        observeParents: true,
    });

    // === ТАБЫ ===
    menuItems.forEach(item => {
        item.addEventListener('click', () => {
            menuItems.forEach(i => i.classList.remove('active'));
            item.classList.add('active');

            const typeId = item.dataset.type;
            const typePartners = allPartners.find(t => t.typeId == typeId)?.partners || [];

            // очистка
            swiper.removeAllSlides();

            // новые слайды
            swiper.appendSlide(
                typePartners.map(p => `
                    <div class="swiper-slide partners__list-item">
                        <img src="${p.logo}" alt="${p.name}" class="partners__img">
                        <div class="partners__name">${p.name}</div>
                    </div>
                `)
            );

            swiper.slideTo(0);
            swiper.update();
        });
    });

});
</script>



{% endblock extra_js %}

